{"version":3,"sources":["Form.jsx"],"names":[],"mappings":";;;;;;;;AAAA;;;;;;;;;;;;IAEqB,I;;;AACnB,gBAAY,KAAZ,EAAkB;AAAA;;AAAA,4GACV,KADU;;AAEhB,UAAK,KAAL,GAAa;AACX,iBAAY,KADD;AAEX,eAAU,SAAS,IAAT,CAAc,YAAd,CAA2B,WAA3B;AAFC,KAAb;AAIA,UAAK,QAAL,GAAgB,MAAK,QAAL,CAAc,IAAd,OAAhB;AACA,UAAK,QAAL,GAAgB,MAAK,QAAL,CAAc,IAAd,OAAhB;AACA,UAAK,IAAL,GAAY,MAAK,IAAL,CAAU,IAAV,OAAZ;AARgB;AASjB;;;;6BAEQ,C,EAAE;AACT,QAAE,cAAF;AACA,UAAM,WAAW,IAAI,QAAJ,CAAa,EAAE,MAAf,CAAjB;AACA,WAAK,IAAL,CAAU,QAAV;AACD;;;yBAEI,Q,EAAS;AAAA;;AACZ,WAAK,QAAL,CAAc,EAAC,WAAY,IAAb,EAAd;AACA,YACE,KAAK,KAAL,CAAW,OAAX,IAAsB,KAAK,KAAL,CAAW,MAAX,IAAqB,KAAK,KAAL,CAAW,MAAtD,IAAgE,OADlE,EAC2E;AACvE,qBAAa,aAD0D;AAEvE,gBAAQ,MAF+D;AAGvE,cAAM;AAHiE,OAD3E,EAMG,IANH,CAMQ,UAAC,QAAD;AAAA,eAAc,SAAS,IAAT,EAAd;AAAA,OANR,EAOG,IAPH,CAOQ,UAAC,IAAD,EAAS;AACb,eAAK,QAAL,CAAc,EAAC,WAAW,KAAZ,EAAd;AACA,eAAK,QAAL,CAAc,IAAd;AACD,OAVH;AAWD;;;6BAEQ,I,EAAK;AAAA;;AACZ,WAAK,QAAL,CAAc;AACZ,eAAO,IADK;AAEZ,mBAAW;AAFC,OAAd;;AAKA,UAAG,KAAK,MAAL,KAAgB,SAAnB,EAA6B;AAC3B,YAAG,KAAK,KAAL,CAAW,eAAX,KAA+B,IAAlC,EAAuC,KAAK,KAAL,CAAW,eAAX,CAA2B,IAA3B;AACxC,OAFD,MAEK;AACH,YAAG,KAAK,KAAL,CAAW,aAAX,KAA6B,IAAhC,EAAqC,KAAK,KAAL,CAAW,aAAX,CAAyB,IAAzB;;AAErC,aAAK,QAAL,CAAc;AACZ,iBAAO,KAAK,IAAL,GAAY,KAAK,IAAL,CAAU;AADjB,SAAd;;AAIA,qBAAa,KAAK,GAAlB;AACA,aAAK,GAAL,GAAW,WAAW,YAAI;AAAC,iBAAK,QAAL,CAAc,EAAC,OAAM,EAAP,EAAd;AAA0B,SAA1C,EAA4C,IAA5C,CAAX;AACD;AACF;;;;EAnD+B,gBAAM,S;;kBAAnB,I","file":"Form.js","sourcesContent":["import React from \"react\";\n\nexport default class Form extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {\n      isLoading : false,\n      urlBase : document.body.getAttribute('data-base')\n    };\n    this.onSubmit = this.onSubmit.bind(this);\n    this.onResult = this.onResult.bind(this);\n    this.post = this.post.bind(this);\n  }\n\n  onSubmit(e){\n    e.preventDefault();\n    const postData = new FormData(e.target);\n    this.post(postData);\n  }\n\n  post(postData){\n    this.setState({isLoading : true});\n    fetch(\n      this.state.urlBase + (this.props.action || this.state.action) + '.json', {\n        credentials: \"same-origin\",\n        method: 'post',\n        body: postData\n      })\n      .then((response) => response.json())\n      .then((data)=> {\n        this.setState({isLoading: false});\n        this.onResult(data);\n      });\n  }\n\n  onResult(data){\n    this.setState({\n      error: null,\n      isLoading: false\n    });\n\n    if(data.status === 'success'){\n      if(this.props.onResultSuccess !== null)this.props.onResultSuccess(data);\n    }else{\n      if(this.props.onResultError !== null)this.props.onResultError(data);\n\n      this.setState({\n        error: data.code + data.info.message\n      });\n\n      clearTimeout(this.iid);\n      this.iid = setTimeout(()=>{this.setState({error:''})}, 4000);\n    }\n  }\n}\n"]}
{"version":3,"sources":["ButtonFacebookLogin.jsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAGqB,mB;;;AACnB,iCAAY,KAAZ,EAAkB;AAAA;;AAAA,4IACV,KADU;;AAEhB,YAAK,OAAL,GAAe,MAAK,OAAL,CAAa,IAAb,OAAf;AACA,YAAK,aAAL,GAAqB,MAAK,aAAL,CAAmB,IAAnB,OAArB;AACA,YAAK,WAAL,GAAmB,MAAK,WAAL,CAAiB,IAAjB,OAAnB;;AAEA,aAAO,WAAP,GAAqB;AAAA,eAAM,aAAG,IAAH,CAAQ;AACjC,iBAAa,MAAM,KADc;AAEjC,iBAAa,KAFoB;AAGjC,mBAAa;AAHoB,SAAR,CAAN;AAAA,OAArB;;AAMA,OAAC,UAAC,CAAD,EAAI,CAAJ,EAAO,EAAP,EAAc;AACb,YAAI,WAAJ;AAAA,YAAQ,MAAM,EAAE,oBAAF,CAAuB,CAAvB,EAA0B,CAA1B,CAAd;AACA,YAAI,EAAE,cAAF,CAAiB,EAAjB,CAAJ,EAA0B;AAAC;AAAQ;AACnC,aAAK,EAAE,aAAF,CAAgB,CAAhB,CAAL,CAAyB,GAAG,EAAH,GAAQ,EAAR;AACzB,WAAG,GAAH,GAAS,qCAAT;AACA,YAAI,UAAJ,CAAe,YAAf,CAA4B,EAA5B,EAAgC,GAAhC;AACD,OAND,EAMG,QANH,EAMa,QANb,EAMuB,gBANvB;AAZgB;AAmBjB;;;;8BAEO,C,EAAE;AAAA;;AACR,UAAE,cAAF;;AAEA,qBAAG,KAAH,CAAS,YAAI;AACX;AACA,uBAAG,cAAH,CAAkB,UAAC,QAAD,EAAY;AAC5B,mBAAK,oBAAL,CAA0B,QAA1B;AACD,WAFD;AAGD,SALD,EAKG,EAAC,OAAO,OAAR,EALH;;AAOA,YAAG,CAAC,KAAK,KAAL,CAAW,OAAf,EAAuB;AACvB,aAAK,KAAL,CAAW,OAAX,CAAmB,CAAnB;AACD;;;2CAEoB,Q,EAAU;AAC7B,YAAI,SAAS,MAAT,KAAoB,WAAxB,EAAqC;AACnC,eAAK,aAAL,CAAmB,SAAS,YAAT,CAAsB,MAAzC,EAAiD,SAAS,YAAT,CAAsB,WAAvE;AACD,SAFD,MAEO,IAAI,SAAS,MAAT,KAAoB,gBAAxB,EAA0C;AAC/C,eAAK,aAAL,CAAmB,QAAnB;AACD,SAFM,MAEA;AACL,eAAK,aAAL,CAAmB,QAAnB;AACD;AACF;;;oCAEa,Q,EAAS;AACrB,aAAK,KAAL,CAAW,aAAX,CAAyB,QAAzB;AACD;;;kCAEW,E,EAAI,K,EAAO,I,EAAK;AAC1B,aAAK,KAAL,CAAW,WAAX,CAAuB,EAAC,IAAG,EAAJ,EAAQ,OAAM,KAAd,EAAqB,MAAK,IAA1B,EAAvB;AACD;;;oCAEa,E,EAAI,K,EAAO;AAAA;;AACvB,qBAAG,GAAH,CAAO,KAAP,EAAc,UAAC,QAAD,EAAY;AACxB,iBAAK,WAAL,CAAiB,EAAjB,EAAqB,KAArB,EAA4B,SAAS,IAArC;AACD,SAFD;AAGD;;;+BAEO;AACN,eACE;AAAA;AAAA,YAAK,WAAW,6BAA6B,KAAK,KAAL,CAAW,SAAX,GAAqB,UAArB,GAAgC,EAA7D,CAAhB,EAAkF,SAAS,KAAK,OAAhG;AAAyG;AAAA;AAAA,cAAG,MAAK,GAAR;AAAY,iDAAG,WAAU,eAAb,GAAZ;AAAA;AAAA;AAAzG,SADF;AAGD;;;;IAhE8C,gBAAM,S;;oBAAlC,mB","file":"ButtonFacebookLogin.js","sourcesContent":["import React from \"react\";\nimport FB from \"fb\";\n\nexport default class ButtonFacebookLogin extends React.Component{\n  constructor(props){\n    super(props);\n    this.onClick = this.onClick.bind(this);\n    this.onConnectFail = this.onConnectFail.bind(this);\n    this.onConnected = this.onConnected.bind(this);\n\n    window.fbAsyncInit = () => FB.init({\n      appId      : props.appId,\n      xfbml      : false,\n      version    : 'v3.0'\n    });\n\n    ((d, s, id) => {\n      let js, fjs = d.getElementsByTagName(s)[0];\n      if (d.getElementById(id)) {return;}\n      js = d.createElement(s); js.id = id;\n      js.src = \"//connect.facebook.net/en_US/sdk.js\";\n      fjs.parentNode.insertBefore(js, fjs);\n    })(document, 'script', 'facebook-jssdk');\n  }\n\n  onClick(e){\n    e.preventDefault();\n\n    FB.login(()=>{\n      //after login, check status\n      FB.getLoginStatus((response)=>{\n        this.statusChangeCallback(response);\n      });\n    }, {scope: 'email'});\n\n    if(!this.props.onClick)return;\n    this.props.onClick(e);\n  }\n\n  statusChangeCallback(response) {\n    if (response.status === 'connected') {\n      this.prepareSignup(response.authResponse.userID, response.authResponse.accessToken)\n    } else if (response.status === 'not_authorized') {\n      this.onConnectFail(response);\n    } else {\n      this.onConnectFail(response);\n    }\n  }\n\n  onConnectFail(response){\n    this.props.onConnectFail(response);\n  }\n\n  onConnected(id, token, name){\n    this.props.onConnected({id:id, token:token, name:name});\n  }\n\n  prepareSignup(id, token) {\n    FB.api('/me', (response)=>{\n      this.onConnected(id, token, response.name);\n    });\n  }\n\n  render(){\n    return (\n      <div className={\"ui button icon facebook\" + (this.props.isLoading?\" loading\":\"\")} onClick={this.onClick}><a href=\"#\"><i className=\"facebook icon\"/>facebook 登入</a></div>\n    );\n  }\n}"]}
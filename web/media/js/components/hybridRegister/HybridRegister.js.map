{"version":3,"sources":["HybridRegister.jsx"],"names":[],"mappings":"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","file":"HybridRegister.js","sourcesContent":["import React from 'react';\nimport Step from '../uiElements/Step';\nimport Steps from '../uiElements/Steps';\nimport Carousel from '../Carousel/Carousel';\nimport Select from './Select';\nimport InputPassword from './InputPassword';\nimport Resend from './Resend';\nimport Login from './Login';\n\nimport {connect} from \"react-redux\";\n\nclass HybridRegister extends React.Component{\n  constructor(props){\n    super(props);\n    this.onPageChange = this.onPageChange.bind(this);\n    this.onRegister = this.onRegister.bind(this);\n    this.onResendConfirmation = this.onResendConfirmation.bind(this);\n    this.onNicknameChange = this.onNicknameChange.bind(this);\n    this.onSignedIn = this.onSignedIn.bind(this);\n  }\n\n  onPageChange(page){\n    this.props.onPageChange(page);\n  }\n\n  onRegister(data){\n    this.props.onRegister(data)\n  }\n\n  onResendConfirmation(data){\n    this.props.onResendConfirmation(data);\n  }\n\n  onNicknameChange(value){\n    this.props.onNicknameChange(value);\n  }\n\n  onSignedIn(data){\n    this.props.onSignedIn(data);\n  }\n\n  render(){\n    let form;\n    switch (this.props.step){\n      case 1:\n        form = (\n          <Carousel onPageChange={this.onPageChange} page={this.props.page}>\n            <Select        action=\"contributor/register_save\" code={this.props.code} onRegister={this.onRegister} onPageChange={this.onPageChange} />\n            <InputPassword action=\"contributor/register_save\" code={this.props.code} onRegister={this.onRegister} defaultValue={this.props.nickname} onNicknameChange={this.onNicknameChange}/>\n          </Carousel>\n        );\n        break;\n      case 2:\n        form = (\n          <div>\n            <div>成功記錄{this.props.nickname}的登入資料，確認電郵已發送到{this.props.email}</div>\n            <Resend onResult={this.onResendConfirmation} action=\"contributor/resend_submit\" email={this.props.email} label=\"重發確認電郵\"/>\n          </div>\n        );\n        break;\n      case 3:\n      case 4:\n        form = (\n          <Login loginMethod={this.props.loginMethod} onSignedIn={this.onSignedIn} defaultEmail={this.props.email}/>\n        );\n    }\n\n    const greeting = (this.props.step < 4) ? (<div className=\"ui content\">多謝 {this.props.nickname} 支持，勁揪體會不時公佈最新進度，請註冊。</div>) : (<div><div>唔該哂！電郵地址成功確認！你已經完成註冊。</div><div>依家即刻登入啦</div></div>);\n    return (\n      <div className=\"multi-page-form\">\n        {greeting}\n        <div><i className=\"ui icon mail\" />你的電郵地址: {this.props.email}</div>\n        <div className=\"br\" />\n\n        <Steps className=\"four\" step={this.props.step}>\n          <Step title=\"設定登入方式\"/>\n          <Step title=\"電郵驗⁠証\" description=\"檢查你的電郵\" />\n          <Step title=\"確認電⁠郵驗⁠証\" description=\"按下電郵內的驗証連結\" />\n          <Step title=\"開始登入\" />\n        </Steps>\n        {form}\n      </div>\n    );\n  }\n}\n\nexport default connect(\n  state => {\n    return {\n      step: state.step,\n      page: state.page,\n      code: state.code,\n      nickname: state.nickname,\n      email: state.email,\n      loginMethod: state.login_method,\n    };\n  },\n  dispatch => {\n    return {\n      onPageChange: (page) => {\n        dispatch({type: \"CHANGE_PAGE\", payload: page});\n      },\n      onRegister: (data) => {\n        if(data.status !== 'success')return;\n\n        dispatch({type: \"CHANGE_STEP\", payload: 2});\n        dispatch({type: \"CHANGE_NICKNAME\", payload: data.nickname});\n      },\n      onResendConfirmation: (data) =>{\n        console.log(data);\n      },\n\n      onNicknameChange:(value) =>{\n        dispatch({type: \"CHANGE_NICKNAME\", payload: value});\n      },\n\n      onSignedIn:(data)=>{\n        const base = document.body.getAttribute('data-base');\n        window.location.href = base + data.destination;\n      }\n    }\n  }\n)(HybridRegister);"]}